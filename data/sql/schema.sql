CREATE TABLE cal (id BIGINT UNSIGNED AUTO_INCREMENT, by_user_id BIGINT UNSIGNED, category_id BIGINT UNSIGNED, name VARCHAR(255), primary_slogan VARCHAR(255), description TEXT, location TEXT, image_path TEXT, access_key VARCHAR(255), created_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, updated_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, INDEX by_user_id_idx (by_user_id), INDEX category_id_idx (category_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE category (id BIGINT UNSIGNED AUTO_INCREMENT, name VARCHAR(255) NOT NULL, image_path TEXT, by_user_id BIGINT UNSIGNED, approved_at DATETIME, parent_id BIGINT UNSIGNED, INDEX by_user_id_idx (by_user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE city (id BIGINT UNSIGNED AUTO_INCREMENT, country_id BIGINT UNSIGNED NOT NULL, state_id BIGINT UNSIGNED, name VARCHAR(255) NOT NULL, nameascii VARCHAR(255), by_user_id BIGINT UNSIGNED, approved_at DATETIME, latitude FLOAT(18, 2), longitude FLOAT(18, 2), zoom SMALLINT, INDEX by_user_id_idx (by_user_id), INDEX country_id_idx (country_id), INDEX state_id_idx (state_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE contact (id BIGINT UNSIGNED AUTO_INCREMENT, subject VARCHAR(255) NOT NULL, message TEXT, created_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, by_user_id BIGINT UNSIGNED, sender_name VARCHAR(255), sender_email VARCHAR(255), INDEX by_user_id_idx (by_user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE country (id BIGINT UNSIGNED AUTO_INCREMENT, name VARCHAR(255) NOT NULL, iso CHAR(2), iso3 CHAR(3), numcode SMALLINT, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE event (id BIGINT UNSIGNED AUTO_INCREMENT, cal_id BIGINT UNSIGNED, name VARCHAR(255), description TEXT, image_path TEXT, location TEXT, starts_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, ends_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, created_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, updated_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, INDEX cal_id_idx (cal_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE invitation (id BIGINT UNSIGNED AUTO_INCREMENT, by_user_id BIGINT UNSIGNED, cal_id BIGINT UNSIGNED NOT NULL, event_id BIGINT UNSIGNED NOT NULL, email VARCHAR(255), created_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, INDEX by_user_id_idx (by_user_id), INDEX cal_id_idx (cal_id), INDEX event_id_idx (event_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE state (id BIGINT UNSIGNED AUTO_INCREMENT, country_id BIGINT UNSIGNED NOT NULL, name VARCHAR(255) NOT NULL, regioncode VARCHAR(50), INDEX country_id_idx (country_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE user (id BIGINT UNSIGNED AUTO_INCREMENT, email VARCHAR(255) NOT NULL, pass VARCHAR(50) NOT NULL, full_name VARCHAR(255) NOT NULL, birthdate DATE, country_id BIGINT UNSIGNED, state_id BIGINT UNSIGNED, city VARCHAR(255), address VARCHAR(255), zip_code VARCHAR(255), created_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, updated_at DATETIME DEFAULT '0000-00-00 00:00:00' NOT NULL, activation_key VARCHAR(255), activation_date DATE, ref_user_id BIGINT UNSIGNED, balance BIGINT DEFAULT '0', type VARCHAR(6) DEFAULT 'SIMPLE', gender VARCHAR(1) NOT NULL, last_login_date DATE, INDEX country_id_idx (country_id), INDEX state_id_idx (state_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE user_cal (id BIGINT UNSIGNED AUTO_INCREMENT, user_id BIGINT UNSIGNED, cal_id BIGINT UNSIGNED, reminder1 INT UNSIGNED, reminder2 INT UNSIGNED, taken_at DATETIME, updated_at DATETIME, INDEX user_id_idx (user_id), INDEX cal_id_idx (cal_id), PRIMARY KEY(id)) ENGINE = INNODB;
ALTER TABLE cal ADD CONSTRAINT cal_category_id_category_id FOREIGN KEY (category_id) REFERENCES category(id);
ALTER TABLE cal ADD CONSTRAINT cal_by_user_id_user_id FOREIGN KEY (by_user_id) REFERENCES user(id);
ALTER TABLE category ADD CONSTRAINT category_by_user_id_user_id FOREIGN KEY (by_user_id) REFERENCES user(id);
ALTER TABLE city ADD CONSTRAINT city_state_id_state_id FOREIGN KEY (state_id) REFERENCES state(id);
ALTER TABLE city ADD CONSTRAINT city_country_id_country_id FOREIGN KEY (country_id) REFERENCES country(id);
ALTER TABLE city ADD CONSTRAINT city_by_user_id_user_id FOREIGN KEY (by_user_id) REFERENCES user(id);
ALTER TABLE contact ADD CONSTRAINT contact_by_user_id_user_id FOREIGN KEY (by_user_id) REFERENCES user(id);
ALTER TABLE event ADD CONSTRAINT event_cal_id_cal_id FOREIGN KEY (cal_id) REFERENCES cal(id);
ALTER TABLE invitation ADD CONSTRAINT invitation_event_id_event_id FOREIGN KEY (event_id) REFERENCES event(id);
ALTER TABLE invitation ADD CONSTRAINT invitation_cal_id_cal_id FOREIGN KEY (cal_id) REFERENCES cal(id);
ALTER TABLE invitation ADD CONSTRAINT invitation_by_user_id_user_id FOREIGN KEY (by_user_id) REFERENCES user(id);
ALTER TABLE state ADD CONSTRAINT state_country_id_country_id FOREIGN KEY (country_id) REFERENCES country(id);
ALTER TABLE user ADD CONSTRAINT user_state_id_state_id FOREIGN KEY (state_id) REFERENCES state(id);
ALTER TABLE user ADD CONSTRAINT user_country_id_country_id FOREIGN KEY (country_id) REFERENCES country(id);
ALTER TABLE user_cal ADD CONSTRAINT user_cal_user_id_user_id FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE user_cal ADD CONSTRAINT user_cal_cal_id_cal_id FOREIGN KEY (cal_id) REFERENCES cal(id);
